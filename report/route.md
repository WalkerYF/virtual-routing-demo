# 路由模块

这里放一下关于路由模块的实现方法。

## 关键：转发表

通过这个表，我们可以知道，为了去到目的子网，需要去到哪一个目的IP。

表中只有三项

|索引|内容|内容|
|-|-|-|
|子网IP|子网掩码|目的IP|

##  自治系统（AS），内部网关协议

1. 自治系统
    1. 在相同的AS中的路由全部运行同样的路由选择算法
1. 网关路由器
    1. 自治系统间有一个网关路由器
1. 内部网关协议
    1. 路由选择信息协议（RIP）
    1. 开放最短路优先（OSPF）

### RIP路由选择信息协议

距离向量

### OSPF

核心：就是一个使用洪泛链路状态信息的链路状态协议和一个Dijkstra最低费用路径算法。

路由器在本地运行Dijkstra最短路径算法，确定一个以自身为根节点的到**所有子网**的最短路径。

#### 报文类型

由IP报文承载，IP报文中上层协议的值为89

1. Hello包 HELLO
    1. 
1. 数据库描述包 DBD
1. 链路状态请求包 LSR
1. 链路状态更新包 LSU
    1. OSPF包类型为4
    1. 1类router lsa：由所有的ospf路由器都会产生，只在区域内传播，包括路由器自身的接口信息，用于描述所有运行OSPF接口的链路状态开销，链路状态ID为始发本LSA的路由器ID，通告路由器ID为始发该LSA的路由器ID。
    1. 2类network lsa：由DR产生，用于描述与DR相连的所有路由器的信息，只在区域内传播，包括DR本身，链路状态ID为DR的接口IP，通告路由器ID为DR的路由器ID。
1. 链路状态确认包 LSAck


#### 数据库

链路状态数据库（LSDB）用来保存当前网络拓扑结构，路由器上属于同一区域的链路状态数据库是相同的（属于多个区域的路由器会为每个区域维护一份链路状态数据库）。